define(function(t){var e=t("../common/lib"),o=t("./WebControl"),r=(t("./blend"),t("../../third_party/zepto.js"),t("./layer/layerapi")),n=function(t){return o.call(this,t),this._init(t),this};e.inherits(n,o),n.prototype.onload=n.prototype.onshow=n.prototype.onhide=e.noop,n.prototype.constructor=n,n.prototype._init=function(t){this._initEvent();var e=this;return this.render(function(){e.ptrFn&&(e.on("layerPullDown",function(){e.ptrFn()}),r.startPullRefresh(e)),t.active&&e.in()},function(){}),this},n.prototype._initEvent=function(){var t=this;t.on("in",t.onshow),t.on("out",t.onhide),t.on("onload",t.onload),t.on("afterrender",t.afterrender),t.on("beforedestroy",function(){t.ptrFn&&r.stopPullRefresh(t),t.off("afterrender"),t.off("onload"),t.off("in",t.onshow),t.off("out",t.onhide)})},n.prototype.type="layer",n.prototype.loadingTime=500,n.prototype.paint=function(t,e){var o=this;return r.prepare(o.id,{url:o.url,top:o.top,left:o.left,bottom:o.bottom,right:o.right,onsuccess:t,onfail:e,pullToRefresh:o.pullToRefresh},o),$(this.main).addClass("page"),this};var s=$(".page");return n.prototype.in=function(){this.fire("changeUrl"),s.removeClass("page-on-center").addClass("page-from-center-to-left"),$(this.main).addClass("page-on-right").appendTo(".pages").addClass("page-from-right-to-center");var t=this;return t.state="slide",this.animationEnd(function(){s.removeClass("page-from-center-to-left").addClass("page-on-left"),$(t.main).removeClass("page-from-right-to-center page-on-right").addClass("page-on-center"),t.fire("aftershow"),t.state=""}),this},n.prototype.out=function(){var t=this;return s.removeClass("page-on-left").addClass("page-from-left-to-center"),$(t.main).removeClass("page-on-center").addClass("page-from-center-to-right"),t.state="slide",this.animationEnd(function(){t.dispose(),s.removeClass("page-from-left-to-center").addClass("page-on-center"),$(t.main).removeClass("page-from-center-to-right").addClass("page-on-right"),t.fire("afterhide"),t.state=""}),this},n.prototype.reload=function(t){var e={url:t,onsuccess:this.onsuccess,onfail:this.onfail,top:this.top,left:this.left,right:this.right,bottom:this.bottom};return r.prepare(this.id,e,this),$("#"+this.main.id).html(""),r.resume(this.id,{},this),this},n.prototype.startPullRefresh=function(t){return r.startPullRefresh(t||this),this},n.prototype.stopPullRefresh=function(t){return r.stopPullRefresh(t||this),this},n.prototype.endPullRefresh=function(t){return r.endPullRefresh(t||this),this},n.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments)},n});