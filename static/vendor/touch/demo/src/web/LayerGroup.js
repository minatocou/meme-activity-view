define(function(e){var t=(e("./blend"),e("../common/lib")),r=e("./Control"),i=!1,o=e("./layer/layerGroupApi"),n=function(e){r.call(this,e),this._init(e)};return t.inherits(n,r),n.prototype.constructor=n,n.prototype.type="layerGroup",n.prototype._init=function(){var e=this,r={},i=null;if(e.layers&&e.layers.length){for(var o=0,n=e.layers.length;n>o;o++)e.layers[o].id||(e.layers[o].id=t.getUniqueID()),e.layers[o].active&&(i=e.layers[o].id),r[e.layers[o].id]=e.layers[o];return e._layers=r,e.activeId=i||e.layers[0].id,e._initEvent(),e.render(),this}},n.prototype._initEvent=function(){var e=this,t=function(t){t.groupId==e.id&&(e.onselected&&e.onselected(t),e._layers[t.layerId].onshow&&e._layers[t.layerId].onshow.call(e),e.activeId!==t.layerId&&e._layers[e.activeId].onhide&&e._layers[e.activeId].onhide.call(e),e.activeId=t.layerId)},r=function(){var t=+new Date;return function(r){var i=+new Date,o=r.groupPixelOffset,n=0==o||1==o;if(n||!(100>i-t)){t=i;var a=r.groupPixelOffset-o>0?"left":"right",l=r.layerId==e.activeId?"left":"right";r.swipe=n?"stop":a,r.dir=n?"stop":l,r.groupId==e.id&&e.onscroll&&e.onscroll.call(e,r)}}};return document.addEventListener("groupSelected",t,!1),document.addEventListener("groupScrolled",r(),!1),null},n.prototype.paint=function(){var e=this;if(i){var t={left:e.left,top:e.top,width:e.width,height:e.height,active:e.activeId};o.create(e.id,e.layers,t)}return this},n.prototype.active=function(e){return o.showLayer(this.id,e),this},n.prototype.remove=function(e){return o.removeLayer(this.id,e),delete this._layers[e],this},n.prototype.add=function(e,r){return e.id||(e.id=t.getUniqueID()),o.addLayer(this.id,e,r),this._layers[e.id]=e,this},n.prototype.updata=function(e,r){return o.updateLayer(this.id,e,r),t.extend(this._layers[r.id],r),this},n.prototype.destroy=function(){r.prototype.destroy.apply(this,arguments)},n});