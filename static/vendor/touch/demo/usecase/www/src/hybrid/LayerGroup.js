define(function(e){var t=(e("./blend"),e("../common/lib")),r=e("./runtime"),i=e("./Control"),n=!0,o=r.layerGroup,a=function(e){i.call(this,e),this._init(e)};return t.inherits(a,i),a.prototype.constructor=a,a.prototype.type="layerGroup",a.prototype._init=function(){var e=this,r={},i=null;if(e.layers&&e.layers.length){for(var n=0,o=e.layers.length;o>n;n++)e.layers[n].id||(e.layers[n].id=t.getUniqueID()),e.layers[n].active&&(i=e.layers[n].id),r[e.layers[n].id]=e.layers[n];return e._layers=r,e.activeId=i||e.layers[0].id,e._initEvent(),e.render(),this}},a.prototype._initEvent=function(){var e=this,t=function(t){t.groupId==e.id&&(e.onselected&&e.onselected(t),e._layers[t.layerId].onshow&&e._layers[t.layerId].onshow.call(e),e.activeId!==t.layerId&&e._layers[e.activeId].onhide&&e._layers[e.activeId].onhide.call(e),e.activeId=t.layerId)},r=function(){var t=+new Date;return function(r){var i=+new Date,n=r.groupPixelOffset,o=0==n||1==n;if(o||!(100>i-t)){t=i;var a=r.groupPixelOffset-n>0?"left":"right",l=r.layerId==e.activeId?"left":"right";r.swipe=o?"stop":a,r.dir=o?"stop":l,r.groupId==e.id&&e.onscroll&&e.onscroll.call(e,r)}}};return document.addEventListener("groupSelected",t,!1),document.addEventListener("groupScrolled",r(),!1),null},a.prototype.paint=function(){var e=this;if(n){var t={left:e.left,top:e.top,width:e.width,height:e.height,active:e.activeId};o.create(e.id,e.layers,t)}return this},a.prototype.active=function(e){return o.showLayer(this.id,e),this},a.prototype.remove=function(e){return o.removeLayer(this.id,e),delete this._layers[e],this},a.prototype.add=function(e,r){return e.id||(e.id=t.getUniqueID()),o.addLayer(this.id,e,r),this._layers[e.id]=e,this},a.prototype.updata=function(e,r){return o.updateLayer(this.id,e,r),t.extend(this._layers[r.id],r),this},a.prototype.destroy=function(){i.prototype.destroy.apply(this,arguments)},a});